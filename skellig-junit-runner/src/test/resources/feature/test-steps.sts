name(User (\w+) prepares a message with score (\w+)) {
   id = step1
   variables {
      id = 00001
      name = ${1}
      score = ${2}
   }
}

name(The user sends the message to (\w+)) {
    id = step2
    receiver = ${1}
    message {
       toCustomFormat {
          id = get(step1).(variables.id)
          userName = get(step1).(variables.name)
          score = get(step1).(variables.score)
       }
    }
}

name(User (\w+) receives valid response from (\w+)) {
   variables {
      # get function with extraction cannot be embedded into regex-comparator at the moment
      score = get(step1).(variables.score)
   }
   validate {
      from_test = step2
      originalRequest [
         regex(.*score=${score}.*)
         contains(${2})
      ]
      receivedBy = ${1}
      status = success
   }
}
